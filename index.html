<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Ad Preview</title>

    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>

    <meta http-equiv="cleartype" content="on">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Ad Preview">

    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://where-spotlight.s3.amazonaws.com/p.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://where-spotlight.s3.amazonaws.com/p.png">
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://where-spotlight.s3.amazonaws.com/p.png">
    <link rel="apple-touch-icon-precomposed" href="http://where-spotlight.s3.amazonaws.com/p.png">
    <link rel="shortcut icon" href="http://where-spotlight.s3.amazonaws.com/p.png">
    <meta name="msapplication-TileImage" content="http://where-spotlight.s3.amazonaws.com/p.png">
    <meta name="msapplication-TileColor" content="#222222">

    <!-- Show background image in preview page -->
    <style type="text/css">
      #preview {
        background-image: url(bg.png);
        background-size: 100%;
        background-repeat: no-repeat;
        background-position-y: 43px;
      }

      #ad-wrapper {
        position: absolute;
        top: 43px;
        left: 3%;
        width: 93%;
        height: 100%;
      }

      #preview #ad-wrapper iframe {
        width: 100%;
        height: 7%;
        margin-top: 12%;
      }
    </style>
  </head>
  <body>

    <div data-role="page" id="input">
      <div data-role="header" data-position="fixed">
        <h1>Ad Preview</h1>
      </div>
      <div data-role="content">
        <form>
          <label for="lineItemId">Line Item ID:</label>
          <input name="lineItemId" type="number" required>

          <label for="publisherId">Publisher ID:</label>
          <input name="publisherId" required>

          <label for="zipCode">Zip Code:</label>
          <input name="zipCode" type="number" required>

          <button type="submit" data-theme="b" name="submit">Preview</button>
        </form>
      </div>
      <div data-role="footer" data-position="fixed"></div>
    </div>

    <div data-role="page" id="preview">
      <div data-role="header" data-position="fixed">
        <h1>Ad Preview</h1>
        <a href="#input" data-icon="gear" class="ui-btn-right" data-transition="slide" data-direction="reverse">Edit</a>
      </div>
      <div data-role="content" id="ad-preview">
        <div id="ad-wrapper"><iframe></iframe></div>
      </div>
      <div data-role="footer" data-position="fixed"></div>
    </div>

    <script type="text/javascript">
      var generateUrl = function($form) {
        var campId = $("input[name=campId]", $form).val();
        var publisherId = $("input[name=publisherId]", $form).val();
        var zipCode = $("input[name=zipCode]", $form).val();
        return "http://ad.where.com/jin/spotlight/ads?context=WA&format=html&ip=38.44.234.343&netid=CAMP_" + campId + "&placementtype=320x50&pubid=" + publisherId + "&ua=Mozilla&v=2.4&zip=" + zipCode;
      };

      $("form").on("submit", function(eventObject) {
        var $adPreview = $("#ad-preview");
        $("iframe", $adPreview).attr("src", generateUrl(this));
        $.mobile.changePage("#preview", { transition: "slide" });
        return false;
      });
    </script>
  </body>
</html>
